<?xml version='1.0' encoding='utf-8'?>
<metamodel xmlns="http://schema.real.com/schema/">
	<include>../commonXml/kernel_metamodel.xml</include>
	<include>../commonXml/classMetamodel.xml</include>
	<namespace>UML 2.0</namespace>
	<diagram name="Hascol Structure">
		<nonGraphicTypes>
			<enum name="Process Operation Kind">
				<value>in</value>
				<value>out</value>
			</enum>
		</nonGraphicTypes>
		<graphicTypes>
			<import name="Class Diagram::Relation" as="Functor Parameter Relation"/>
			<import name="Class Diagram::Aggregation" as="Used Process Relation"/>
			<import name="Class Diagram::Composition" as="Nested Process Relation"/>
			<import name="Class Diagram::Generalization" as="Generalization"/>
			<import name="Kernel::Comment" as="Comment"/>
			<import name="Kernel::Comment Link" as="Comment Link"/>
			<import name="Kernel::Diagram" as="Diagram"/>
			<node name="Process">
				<graphics>
					<picture sizex="150" sizey="210">
						<rectangle fill="#ffffff" stroke-style="solid" stroke="#000000" y1="0" x1="0" y2="210"
								   stroke-width="1" x2="150" fill-style="solid"/>
						<line fill="#000000" stroke-style="solid" stroke="#000000" y1="25a" x1="0" y2="25a"
							  stroke-width="1" x2="150" fill-style="solid"/>
						<line fill="#000000" stroke-style="solid" stroke="#000000" y1="100" x1="0" y2="100"
							  stroke-width="1" x2="150" fill-style="solid"/>
					</picture>
					<labels>
						<label x="0" y="0" textBinded="name"/>
					</labels>
					<ports>
						<linePort>
							<start startx="0" starty="0"/>
							<end endx="150" endy="0"/>
						</linePort>
						<linePort>
							<start startx="150" starty="0"/>
							<end endx="150" endy="210"/>
						</linePort>
						<linePort>
							<start startx="150" starty="210"/>
							<end endx="0" endy="210"/>
						</linePort>
						<linePort>
							<start startx="0" starty="210"/>
							<end endx="0" endy="0"/>
						</linePort>
					</ports>
				</graphics>
				<logic>
					<generalizations>
						<parent parentName="Kernel::Classifier"/>
					</generalizations>
					<properties>
						<property type="string" name="implementation"/>
					</properties>
				</logic>
			</node>
			<node name="Process Operation">
				<graphics>
					<picture sizex="100" sizey="20"/>
					<labels>
						<label x="0" y="0" textBinded="direction"/>
						<label x="20" y="0" textBinded="name"/>
					</labels>
				</graphics>
				<logic>
					<generalizations>
						<parent parentName="Kernel::Classifier"/>
					</generalizations>
					<properties>
						<!-- <property type="Process Operation Kind" name="direction"/> -->
						<property type="string" name="direction"/>
					</properties>
				</logic>
			</node>
			<node name="Resource">
				<graphics>
					<picture sizex="100" sizey="20"/>
					<labels>
						<label x="0" y="0" textBinded="name"/>
					</labels>
				</graphics>
				<logic>
					<generalizations>
						<parent parentName="Kernel::Classifier"/>
					</generalizations>
					<properties>
						<property type="string" name="type"/>
					</properties>
				</logic>
			</node>
			<node name="Functor">
				<graphics>
					<picture sizex="250" sizey="210">
						<rectangle x1="0" y1="50" y2="210" x2="150" />
						<line x1="0" y1="75" x2="150" y2="75" />
						<line x1="0" y1="140" x2="150" y2="140" />
						<rectangle x1="100" y1="0" y2="55" x2="250" stroke-style="dash" fill-style="solid" fill="#ffffff"/>
					</picture>
					<labels>
						<label x="0" y="50" textBinded="name"/>
					</labels>
					<ports>
						<linePort>
							<start startx="0" starty="50"/>
							<end endx="100" endy="50"/>
						</linePort>
						<linePort>
							<start startx="150" starty="55"/>
							<end endx="150" endy="210"/>
						</linePort>
						<linePort>
							<start startx="150" starty="210"/>
							<end endx="0" endy="210"/>
						</linePort>
						<linePort>
							<start startx="0" starty="210"/>
							<end endx="0" endy="50"/>
						</linePort>
					</ports>
				</graphics>
				<logic>
					<generalizations>
						<parent parentName="Process"/>
					</generalizations>
				</logic>
			</node>
			<node name="Functor Parameter">
				<graphics>
					<picture sizex="140" sizey="20"/>
					<labels>
						<label x="0" y="0" textBinded="name"/>
					</labels>
					<ports>
						<pointPort x="140" y="10"/>
					</ports>
				</graphics>
				<logic>
				</logic>
			</node>
			<edge name="Functor Binding">
				<graphics>
					<lineType type="dashLine"/>
				</graphics>
				<logic>
					<associations beginType="empty_arrow" endType="no_arrow">
						<association beginName="Functor"
							endName="Process"/>
					</associations>
					<generalizations>
						<parent parentName="Kernel::Relationship"/>
					</generalizations>
					<properties>
						<property type="string" name="parameter bindings" />
					</properties>
				</logic>
			</edge>
		</graphicTypes>
	</diagram>
	
	<diagram name="Hascol Port Mapping">
		<!-- За неимением диаграммы композитных структур - ад-хок реализация -->
		<graphicTypes>
			<import name="Class Diagram::Relation" as="Port Mapping Relation"/>
			<import name="Hascol Structure::Functor Parameter" as="Functor Parameter"/>
			<node name="Process Instance"> <!-- Должно наследоваться от EncapsulatedClassifier и TypedElement -->
				<graphics>
					<picture sizex="200" sizey="100">
						<rectangle x1="20a" y1="0" x2="180" y2="100" />
					</picture>
					<labels>
						<label x="20" y="0" textBinded="name"/>
					</labels>
				</graphics>
				<logic>
				</logic>
			</node>
			<node name="Functor Instance">
				<graphics>
					<picture sizex="250" sizey="130">
						<rectangle x1="20a" y1="30a" x2="180" y2="130" />
						<rectangle x1="150" y1="0a" x2="250" y2="35a" stroke-style="dash" fill-style="solid" fill="#ffffff"/>
					</picture>
					<labels>
						<label x="20" y="30" textBinded="name"/>
					</labels>
				</graphics>
				<logic>
					<generalizations>
						<parent parentName="Process Instance"/>
					</generalizations>
				</logic>
			</node>
			<node name="Port"> <!-- Это просто порт из композитных структур + атрибут direction -->
				<graphics>
					<picture sizex="100" sizey="10">
						<rectangle x1="0" y1="0" x2="10" y2="10" fill="#ffffff" fill-style="solid"/>
					</picture>
					<labels>
						<label x="10" y="-10" textBinded="direction"/>
						<label x="30" y="-10" textBinded="name"/>
					</labels>
					<ports>
						<linePort>
							<start startx="0" starty="0"/>
							<end endx="0" endy="10"/>
						</linePort>
						<linePort>
							<start startx="10" starty="0"/>
							<end endx="10" endy="10"/>
						</linePort>
						<linePort>
							<start startx="0" starty="0"/>
							<end endx="10" endy="0"/>
						</linePort>
						<linePort>
							<start startx="0" starty="10"/>
							<end endx="10" endy="10"/>
						</linePort>
					</ports>
				</graphics>
				<logic>
					<properties>
						<!-- <property type="Process Operation Kind" name="direction"/> -->
						<property type="string" name="direction"/>
					</properties>
				</logic>
			</node>
		</graphicTypes>
	</diagram>
</metamodel>
